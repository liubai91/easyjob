(function(){"use strict";var t={485:function(t,e,a){var r=a(7195),o=a(5114),l=a.n(o),n=a(2241),s=function(){var t=this,e=t._self._c;return e("div",[e("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"调度中心",name:"scheduler-manager"}}),e("el-tab-pane",{attrs:{label:"任务管理",name:"task-manager"}}),e("el-tab-pane",{attrs:{label:"任务日志",name:"task-logger"}})],1),e("router-view")],1)},i=[],c=(a(7658),{name:"SchedulerPage",data(){return{activeName:""}},mounted(){var t=this.$router.currentRoute.path,e=t.substring(t.lastIndexOf("/")+1);console.log(e),this.activeName=e},methods:{handleClick(t){console.log(t),this.$router.push("/task/"+t.name)}}}),u=c,d=a(1001),p=(0,d.Z)(u,s,i,!1,null,"06bd236f",null),h=p.exports,m=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"margin-top":"20px"}},[e("span",[t._v("调度中心运行状态：")]),e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#cccccc"},on:{change:t.startOrstopScheduler},model:{value:t.schedulerState,callback:function(e){t.schedulerState=e},expression:"schedulerState"}}),1==t.schedulerState?e("span",[t._v("运行中")]):e("span",[t._v("停止")])],1),e("div",{staticStyle:{"margin-top":"30px"}},[e("span",{staticClass:"demonstration"},[t._v("当前正在运行的任务列表：")]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"180"}}),e("el-table-column",{attrs:{prop:"startTime",label:"任务开始时间",width:"180",formatter:t.showTime}})],1)],1)])},g=[],b=a(306);const f=b.Z.create({timeout:3e4,headers:{"Content-Type":"application/json; charset=utf-8"}});f.interceptors.request.use((t=>(t.headers["Authorization"]="Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImF1dGgiOiJST0xFX0FETUlOLFJPTEVfQUxMX0FETUlTU0lPTixST0xFX0FMTF9BTExFUkdZSElTVE9SWSxST0xFX0FMTF9BTkRST0xPR1lFWEFNLFJPTEVfQUxMX0JFRElORk8sUk9MRV9TRUxFQ1RfUExBTkxPRyxST0xFX1NFTEVDVF9QUkVHTkFOQ1lISVNUT1JZLFJPTEVfU0VMRUNUX1BSRU1BUklUQUxFWEFNLFJPTEVfU0VMRUNUX1BSRU1BUklUQUxWSVNJVCxST0xFX1NFTEVDVF9QUkVOQVRBTERJQUdOT1NJUyxST0xFX1NFTEVDVF9QUkVOQVRBTEVYQU0sUk9MRV9TRUxFQ1RfUFJFTkFUQUxQQVRJRU5ULFJPTEVfU0VMRUNUX1BSRU5BVEFMU0NSRUVOLFJPTEVfU0VMRUNUX1BSRU5BVEFMVklTSVQiLCJpZCI6NTA5LCJjbk5hbWUiOiJhZG1pbiIsImV4cCI6MTY4MDcxNDQ0NH0.0vzHvgoR8w8F0NV9Cyc6-kkmViXHQ7ASSH_AuDxa6VC8VgWHaDp8LtltRv2soW4kaTfLXGkC1oZyDxsAwniNRg",t))),Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t};var v=f;const k="";function T(t={}){return v({url:k+"jobmetadata.json",method:"post",data:t})}function x(t={}){return v({url:k+"listjob.json",method:"post",data:t})}function y(t={}){console.log("post:"+t);const e=JSON.stringify(t);return console.log("post:"+e),v({url:k+"savejob.json",method:"post",data:e})}function S(t={}){return v({url:k+"getjob.json",method:"get",params:t})}function w(t={}){return v({url:k+"deljob.json",method:"get",params:t})}function M(t={}){return v({url:k+"schejob.json",method:"get",params:t})}function C(t={}){return v({url:k+"unschejob.json",method:"get",params:t})}function U(t={}){return v({url:k+"listjoblogs.json",method:"post",data:t})}function j(t={}){return v({url:k+"startscheduler.json",method:"post",data:t})}function F(t={}){return v({url:k+"stopscheduler.json",method:"post",data:t})}function O(t={}){return v({url:k+"statusscheduler.json",method:"post",data:t})}function E(t={}){return v({url:k+"listrunnningjob.json",method:"post",data:t})}var D={name:"SchedulerManager",data(){return{schedulerState:!1,list:[]}},computed:{},mounted(){this.getTableData()},methods:{getTableData(){E().then((t=>{this.list=t.data})),O().then((t=>{this.schedulerState=t.data.flag}))},startOrstopScheduler(){console.log(this.schedulerState),this.schedulerState?(console.log("开启调度器"),j().then((()=>{this.getTableData()}))):(console.log("停止调度器"),F().then((()=>{this.getTableData()})))},showTime(t,e,a){var r=new Date(a);return r.Format("yyyy-MM-dd HH:mm:ss")}}},R=D,V=(0,d.Z)(R,m,g,!1,null,"7cdbc1aa",null),_=V.exports,J=function(){var t=this,e=t._self._c;return e("div",[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.criteria}},[e("el-form-item",{attrs:{label:"任务名称"}},[e("el-input",{attrs:{placeholder:"任务名称"},model:{value:t.criteria.name,callback:function(e){t.$set(t.criteria,"name",e)},expression:"criteria.name"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.getTableData}},[t._v("查询")])],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editJob(null)}}},[t._v("新建任务")])],1)],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"180",sortable:"custom"}}),e("el-table-column",{attrs:{prop:"description",label:"任务描述",width:"180"}}),e("el-table-column",{attrs:{prop:"targetObject",label:"任务Bean",width:"180"}}),e("el-table-column",{attrs:{prop:"targetMethod",label:"任务方法",width:"180"}}),e("el-table-column",{attrs:{prop:"triggerType",label:"触发器类型",width:"180",formatter:t.showTriggerType}}),e("el-table-column",{attrs:{prop:"enable",label:"任务状态",width:"180",formatter:t.showJobStatus}}),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.enable?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.unscheJob(a.row)}}},[t._v("取消调度")]):e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.scheJob(a.row)}}},[t._v("调度")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.editJob(a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.deleteJob(a.row)}}},[t._v("删除")])]}}])})],1),e("div",{staticClass:"block"},[e("el-row",[e("el-col",{attrs:{span:8,offset:8}},[e("el-pagination",{attrs:{"current-page":t.criteria.pageCur,"page-sizes":[5,8,10,20],"page-size":t.criteria.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.criteria.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)],1)},z=[],$={name:"TaskManager",data(){return{list:[],criteria:{name:"",state:"",pageSize:5,pageCur:1,total:0},openEditDialog:!1}},mounted(){this.getTableData()},methods:{getTableData(){console.log("获取服务器数据"),x({name:this.criteria.name,pageCur:this.criteria.pageCur,pageSize:this.criteria.pageSize}).then((t=>{console.log(t),this.list=t.data.data,this.criteria.total=t.data.count}))},onSubmit(){},handleSizeChange(t){this.criteria.pageSize=t,this.getTableData()},handleCurrentChange(t){this.criteria.pageCur=t,this.getTableData()},editJob(t){console.log(t),t?this.$router.push("/task/task-edit/"+t.id):(console.log("新建页面"),this.$router.push("/task/task-edit/0"))},deleteJob(t){w({id:t.id}).then((t=>{console.log(t),this.getTableData()}))},scheJob(t){M({id:t.id}).then((t=>{console.log(t),this.getTableData()}))},unscheJob(t){C({id:t.id}).then((t=>{console.log(t),this.getTableData()}))},openOrCloseDialog(t){this.openEditDialog=t,this.getTableData()},showTriggerType(t,e,a){return"RIGHTNOW"==a?"立即执行":"DELAY"==a?"指定时间":"循环执行"},showJobStatus(t,e,a){return a?"已调度":"未调度"}}},N=$,P=(0,d.Z)(N,J,z,!1,null,"2599c1b4",null),Q=P.exports,B=function(){var t=this,e=t._self._c;return e("div",[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.criteria}},[e("el-form-item",{attrs:{label:"任务名称"}},[e("el-input",{attrs:{placeholder:"任务名称"},model:{value:t.criteria.name,callback:function(e){t.$set(t.criteria,"name",e)},expression:"criteria.name"}})],1),e("el-form-item",{attrs:{label:"执行结果"}},[e("el-select",{attrs:{placeholder:"执行结果"},model:{value:t.criteria.state,callback:function(e){t.$set(t.criteria,"state",e)},expression:"criteria.state"}},[e("el-option",{attrs:{label:"正常",value:"正常"}}),e("el-option",{attrs:{label:"异常",value:"异常"}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.getTasklog}},[t._v("查询")])],1)],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.logs}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"180",sortable:"custom"}}),e("el-table-column",{attrs:{prop:"startTime",label:"开始时间",width:"180",formatter:t.showTime}}),e("el-table-column",{attrs:{prop:"endTime",label:"结束时间",width:"180",formatter:t.showTime}}),e("el-table-column",{attrs:{prop:"duration",label:"持续时长(ms)",width:"180"}}),e("el-table-column",{attrs:{prop:"state",label:"执行结果",width:"180"}}),e("el-table-column",{attrs:{prop:"exceptionBrief",label:"异常摘要",width:"180"}}),e("el-table-column",{attrs:{prop:"address",label:"异常详情"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"left",width:"1000",trigger:"click"}},[e("el-input",{attrs:{type:"textarea",autosize:""},model:{value:a.row.exceptionDetail,callback:function(e){t.$set(a.row,"exceptionDetail",e)},expression:"scope.row.exceptionDetail"}}),e("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("查看")])],1)]}}])})],1),e("div",{staticClass:"block"},[e("el-row",[e("el-col",{attrs:{span:8,offset:8}},[e("el-pagination",{attrs:{"current-page":t.criteria.pageCur,"page-sizes":[5,8,10,20],"page-size":t.criteria.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.criteria.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)],1)},L=[],H={name:"TaskLogger",data(){return{logs:[],criteria:{name:"",state:"",pageSize:5,pageCur:1,total:0}}},mounted(){this.getTasklog()},methods:{getTasklog(){console.log("获取服务器数据"),U({name:this.criteria.name,pageCur:this.criteria.pageCur,pageSize:this.criteria.pageSize,state:this.criteria.state}).then((t=>{console.log(t),this.logs=t.data.data,this.criteria.total=t.data.count}))},onSubmit(){},handleSizeChange(t){this.criteria.pageSize=t,this.getTasklog()},handleCurrentChange(t){this.criteria.pageCur=t,this.getTasklog()},showTime(t,e,a){var r=new Date(a);return r.Format("yyyy-MM-dd HH:mm:ss")}}},X=H,Z=(0,d.Z)(X,B,L,!1,null,"a207d102",null),A=Z.exports,I=function(){var t=this,e=t._self._c;return e("el-row",{attrs:{gutter:20}},[e("el-col",{staticStyle:{height:"20px"},attrs:{span:6}}),e("el-col",{attrs:{span:12}},[e("el-form",{ref:"jobForm",attrs:{"label-width":"120px",model:t.data,rules:t.rules}},[e("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[e("el-input",{model:{value:t.data.name,callback:function(e){t.$set(t.data,"name",e)},expression:"data.name"}})],1),e("el-form-item",{attrs:{label:"任务对象",prop:"targetObject"}},[e("el-select",{on:{change:t.handleTargetObjectChanage},model:{value:t.data.targetObject,callback:function(e){t.$set(t.data,"targetObject",e)},expression:"data.targetObject"}},t._l(t.task,(function(t,a){return e("el-option",{key:a,attrs:{label:t.alias,value:t.name}})})),1)],1),e("el-form-item",{attrs:{label:"任务方法",prop:"targetMethod"}},[e("el-select",{on:{change:t.handleTaskSelected},model:{value:t.data.targetMethod,callback:function(e){t.$set(t.data,"targetMethod",e)},expression:"data.targetMethod"}},t._l(t.taskMethodMetas,(function(t,a){return e("el-option",{key:a,attrs:{label:t.alias,value:t.name}})})),1)],1),t._l(t.taskParamMetas,(function(a,r){return e("el-form-item",{key:r,attrs:{label:a.name}},["int"==a.type?e("el-input",{attrs:{type:"number",name:"param"},model:{value:t.data.params[r],callback:function(e){t.$set(t.data.params,r,e)},expression:"data.params[index]"}}):"java.util.Date"==a.type?e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.data.params[r],callback:function(e){t.$set(t.data.params,r,e)},expression:"data.params[index]"}}):e("el-input",{attrs:{type:"text",name:"param"},model:{value:t.data.params[r],callback:function(e){t.$set(t.data.params,r,e)},expression:"data.params[index]"}})],1)})),e("el-form-item",{attrs:{label:"任务描述"}},[e("el-input",{attrs:{type:"textarea",autosize:""},model:{value:t.data.description,callback:function(e){t.$set(t.data,"description",e)},expression:"data.description"}})],1),e("el-form-item",{attrs:{label:"触发器类型",prop:"triggerType"}},[e("el-select",{model:{value:t.data.triggerType,callback:function(e){t.$set(t.data,"triggerType",e)},expression:"data.triggerType"}},[e("el-option",{attrs:{label:"立即执行",value:"RIGHTNOW"}}),e("el-option",{attrs:{label:"指定时间",value:"DELAY"}}),e("el-option",{attrs:{label:"循环执行",value:"REGULAR"}})],1)],1),"DELAY"==t.data.triggerType?e("el-form-item",{attrs:{label:"执行时间",prop:"fireTime"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期"},model:{value:t.data.fireTime,callback:function(e){t.$set(t.data,"fireTime",e)},expression:"data.fireTime"}})],1):t._e(),"REGULAR"==t.data.triggerType?e("el-form-item",{attrs:{label:"cron表达式",prop:"cronExpression"}},[e("el-input",{model:{value:t.data.cronExpression,callback:function(e){t.$set(t.data,"cronExpression",e)},expression:"data.cronExpression"}}),e("el-button",{attrs:{type:"primary"},on:{click:t.showDialog}},[t._v("生成 cron")])],1):t._e(),e("el-dialog",{attrs:{title:"生成 cron",visible:t.showCron},on:{"update:visible":function(e){t.showCron=e}}},[e("vcrontab",{attrs:{expression:t.data.cronExpression},on:{hide:function(e){t.showCron=!1},fill:t.crontabFill}})],1),e("el-form-item",{attrs:{label:"异常处理策励",prop:"strategy"}},[e("el-select",{model:{value:t.data.strategy,callback:function(e){t.$set(t.data,"strategy",e)},expression:"data.strategy"}},[e("el-option",{attrs:{label:"继续",value:"GOON"}}),e("el-option",{attrs:{label:"中止",value:"BREAK"}})],1)],1)],2),e("div",{},[e("el-button",{on:{click:t.exitEdit}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveTask}},[t._v("确 定")])],1)],1),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"grid-content bg-purple"})])],1)},G=[],W=a(4150),q=a.n(W),Y={name:"AddOrEditTask",data(){return{data:{params:[]},task:[],input:"",expression:"",showCron:!1,rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],targetObject:[{required:!0,message:"请选择任务对象",trigger:"blur"}],targetMethod:[{required:!0,message:"请选择任务方法",trigger:"blur"}],triggerType:[{required:!0,message:"请选择执行类型",trigger:"blur"}],strategy:[{required:!0,message:"请选择异常处理策略",trigger:"blur"}],fireTime:[{required:!0,message:"请选择执行时间",trigger:"blur"}],cronExpression:[{required:!0,message:"请选择执行时间",trigger:"blur"}]}}},mounted(){this.getTaskMetaData(),this.retriveJob()},computed:{taskMethodMetas:function(){var t=this.task.find((t=>!(!this.data.targetObject||t.name!=this.data.targetObject)));return null!=t?t.methods:[]},taskParamMetas:function(){var t=this.taskMethodMetas.find((t=>!(!this.data.targetMethod||t.name!=this.data.targetMethod)));return null!=t?t.params:[]}},methods:{getTaskMetaData(){T({}).then((t=>{this.task=t.data,console.log(t)}))},retriveJob(){const t=this.$route.params.id;t>0&&S({id:t}).then((t=>{console.log(t);var e=t.data;e.targetParams?e.params=e.targetParams.split(","):e.params=[],this.data=t.data}))},handleTargetObjectChanage(){this.data.targetMethod=null,this.data.description=""},init(t){t&&(t.targetParams&&(t.params=t.targetParams.split(",")),this.data=t)},handleClose(){this.data={params:[]},this.openOrCloseDialog(!1)},handleTaskSelected(t){console.log("选中"+t);var e=this.taskMethodMetas.find((t=>!(!this.data.targetMethod||t.name!=this.data.targetMethod)));this.data.description=e.description},saveTask(){this.$refs["jobForm"].validate((t=>{if(!t)return!1;this.dosaveTask()}))},dosaveTask(){var t=new Object;Object.assign(t,this.data),this.data.params&&(t.targetParams=this.data.params.join(",")),y(t).then((t=>{console.log(t),this.data={params:[]},this.$router.back()}))},exitEdit(){this.$router.back()},crontabFill(t){this.data.cronExpression=t},showDialog(){this.showCron=!0}},components:{vcrontab:q()},props:["dialogVisible","openOrCloseDialog"]},K=Y,tt=(0,d.Z)(K,I,G,!1,null,"505eb343",null),et=tt.exports;const at=[{path:"/task",component:h,children:[{path:"scheduler-manager",component:_},{path:"task-manager",component:Q},{path:"task-logger",component:A},{path:"task-edit/:id",component:et}]},{path:"/**",redirect:"/task/task-manager"}];var rt=at;r["default"].prototype.$http=v,console.log(rt);const ot=new n.ZP({routes:rt});r["default"].config.productionTip=!1,r["default"].use(l()),r["default"].use(n.ZP),new r["default"]({render:t=>t(n.MA),router:ot}).$mount("#app")}},e={};function a(r){var o=e[r];if(void 0!==o)return o.exports;var l=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,r,o,l){if(!r){var n=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],l=t[u][2];for(var s=!0,i=0;i<r.length;i++)(!1&l||n>=l)&&Object.keys(a.O).every((function(t){return a.O[t](r[i])}))?r.splice(i--,1):(s=!1,l<n&&(n=l));if(s){t.splice(u--,1);var c=o();void 0!==c&&(e=c)}}return e}l=l||0;for(var u=t.length;u>0&&t[u-1][2]>l;u--)t[u]=t[u-1];t[u]=[r,o,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,l,n=r[0],s=r[1],i=r[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(i)var u=i(a)}for(e&&e(r);c<n.length;c++)l=n[c],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(u)},r=self["webpackChunkvuedemo1"]=self["webpackChunkvuedemo1"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(485)}));r=a.O(r)})();
//# sourceMappingURL=app.500c9d37.js.map